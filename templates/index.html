{% extends "base.html" %}

{% block title %}Inicio - GSM Monitor MX{% endblock %}

{% block content %}
<div class="row">
    <div class="col-lg-8 mx-auto">
        <div class="card shadow">
            <div class="card-header bg-primary text-white">
                <h4 class="mb-0"><i class="bi bi-wifi"></i> Configuración de Monitoreo</h4>
            </div>
            <div class="card-body">
                <form id="monitoring-form">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Número Telefónico</label>
                                <input type="text" class="form-control" id="phone_number" 
                                       placeholder="10 dígitos (opcional)" pattern="\d{10}">
                                <div class="form-text">Dejar vacío para monitoreo aleatorio</div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Operador</label>
                                <select class="form-select" id="operator">
                                    <option value="telcel">Telcel</option>
                                    <option value="movistar">Movistar</option>
                                    <option value="att">AT&T</option>
                                    <option value="unefon">Unefon</option>
                                    <option value="altan">Altan</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Duración</label>
                                <select class="form-select" id="duration">
                                    <option value="2">2 horas (Rápido)</option>
                                    <option value="6">6 horas</option>
                                    <option value="12">12 horas</option>
                                    <option value="24" selected>24 horas (Completo)</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Visualización</label>
                                <select class="form-select" id="visualization">
                                    <option value="map">Mapa Interactivo</option>
                                    <option value="coordinates">Solo Coordenadas</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="d-grid gap-2">
                        <button type="submit" class="btn btn-success btn-lg" id="start-btn">
                            <i class="bi bi-play-circle"></i> Iniciar Monitoreo
                        </button>
                        <button type="button" class="btn btn-danger btn-lg" id="stop-btn" disabled>
                            <i class="bi bi-stop-circle"></i> Detener Monitoreo
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Panel de Progreso -->
        <div class="card shadow mt-4" id="progress-panel" style="display: none;">
            <div class="card-header bg-info text-white">
                <h5 class="mb-0"><i class="bi bi-graph-up"></i> Progreso del Monitoreo</h5>
            </div>
            <div class="card-body">
                <div class="mb-3">
                    <div class="d-flex justify-content-between">
                        <span id="current-operation">Iniciando...</span>
                        <span id="progress-text">0%</span>
                    </div>
                    <div class="progress" style="height: 25px;">
                        <div id="progress-bar" class="progress-bar progress-bar-striped progress-bar-animated" 
                             role="progressbar" style="width: 0%"></div>
                    </div>
                </div>
                
                <div class="row text-center">
                    <div class="col-md-3">
                        <div class="card bg-light">
                            <div class="card-body">
                                <h4 id="imsi-count">0</h4>
                                <small>IMSIs Detectados</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card bg-light">
                            <div class="card-body">
                                <h4 id="location-count">0</h4>
                                <small>Ubicaciones</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card bg-light">
                            <div class="card-body">
                                <h4 id="cell-count">0</h4>
                                <small>Celdas Únicas</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="card bg-light">
                            <div class="card-body">
                                <h4 id="packet-count">0</h4>
                                <small>Paquetes</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Resultados en Tiempo Real -->
        <div class="card shadow mt-4" id="results-panel" style="display: none;">
            <div class="card-header bg-success text-white">
                <h5 class="mb-0"><i class="bi bi-table"></i> Resultados en Tiempo Real</h5>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-striped table-hover">
                        <thead>
                            <tr>
                                <th>IMSI</th>
                                <th>Última Ubicación</th>
                                <th>Precisión</th>
                                <th>Hora</th>
                            </tr>
                        </thead>
                        <tbody id="results-table">
                        </tbody>
                    </table>
                </div>
                
                <div class="mt-3">
                    <button class="btn btn-outline-primary me-2" id="export-json">
                        <i class="bi bi-download"></i> Exportar JSON
                    </button>
                    <button class="btn btn-outline-secondary" id="export-csv">
                        <i class="bi bi-download"></i> Exportar CSV
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
